import os.path
import glob
from collections.abc import Iterable
import win32com.client

import openpyxl
import requests
from bs4 import BeautifulSoup
# влад
START_ROW_VEDOM = 5
END_ROW_VEDOM = 37
# игорь
START_ROW_VEDOM = 4
END_ROW_VEDOM = 54
# moi
# START_ROW_VEDOM = 5
# END_ROW_VEDOM = 38

abspath = os.getcwd()
DIRECTORY = os.path.join(abspath, 'файлы')


def parce_vedom():
    vedom = glob.glob(os.path.join(DIRECTORY, '*.xlsx'))[0]
    file = openpyxl.load_workbook(vedom, data_only=True)
    sheet = file["ВОР"]

    name_work = [cell.value.strip() for cell in sheet['B'][START_ROW_VEDOM - 1:END_ROW_VEDOM] if cell.value]
    GSN = [cell.value.strip().lower().replace('гэсн', '').strip() for cell in
           sheet['E'][START_ROW_VEDOM - 1:END_ROW_VEDOM]
           if cell.value]
    units_measurement = [cell.value for cell in sheet['C'][START_ROW_VEDOM - 1:END_ROW_VEDOM] if cell.value]
    volume = [cell.value for cell in sheet['D'][START_ROW_VEDOM - 1:END_ROW_VEDOM] if cell.value]

    file.close()

    return [{work: {'gsn': gsn, 'volume': vol, 'units_measurement': un}}
            for work, gsn, vol, un in zip(name_work, GSN, volume, units_measurement)]


def parce_defsmeta(gsn):
    resources = {g: [] for g in gsn}
    temp_url = r'https://www.defsmeta.com/rgsn/gsn_{}/giesn-{}.php'

    for code in gsn:
        main_code = code.split('-')[0]
        url = temp_url.format(main_code, code)
        page = requests.get(url)
        soup = BeautifulSoup(page.text, 'lxml')

        for label, type_res in zip(
                ('РАСХОД МАТЕРИАЛОВ', 'ЭКСПЛУАТАЦИЯ МАШИН И МЕХАНИЗМОВ', 'ТРУДОЗАТРАТЫ'),
                ('material', 'machine', 'people')
        ):
            start_element = soup.find('p', string=label)
            if start_element:
                elements_between = []
                current_element = start_element
                for _ in range(3):
                    elements_between.append(current_element)
                    current_element = current_element.find_next()
                table = elements_between[2]
                rows = table.find_all('tr')
                if label == 'ТРУДОЗАТРАТЫ':
                    rows = rows[1:-len(rows) // 2]
                else:
                    rows = rows[1:-1]

                for material in rows:
                    material = material.find_all('td')
                    if label == 'ТРУДОЗАТРАТЫ':
                        material = material[1:]
                        consumption = float(material[2].text.replace(',', '.'))
                        unit = material[1].text
                        name = material[0].text
                    else:
                        material = material[1:-1]
                        consumption = float(material[3].text.replace(',', '.'))
                        unit = material[2].text
                        name = material[1].text

                    resources[code].append({
                        'name': name,
                        'consumption': consumption,
                        'type': type_res,
                        'unit': unit.replace('\xa0', '')
                    })
                    if resources[code][-1]['unit'] == 'м':
                        resources[code][-1]['unit'] = 'метры'

    return resources


class MSProject:
    def __init__(self, file):
        self.mpp = win32com.client.Dispatch("MSProject.Application")
        self.mpp.FileOpen(file)
        self.project = self.mpp.ActiveProject

    def delete_resources(self, resource_name: Iterable):
        for r in self.project.Resources:
            if r.name in resource_name:
                r.Delete()

    def delete_all_resources(self):
        self.delete_resources(self.get_name_of_resources())

    def add_resources(self, resource_name: Iterable):
        for name in resource_name:
            self.project.Resources.Add(Name=name)

    def get_name_of_resources(self):
        return [r.name for r in self.project.Resources]

    def get_resources_name_id(self):
        return {t.Name: t.Id for t in self.project.Resources}

    def get_tasks_id_name(self):
        return {t.Id: t.Name for t in self.project.Tasks}

    def get_resources_object(self):
        return self.project.Resources

    def get_tasks_object(self):
        return self.project.Tasks

    def _save_file(self):
        self.mpp.FileSave()

    def _close_file(self):
        self.mpp.Quit()

    def close(self):
        self._save_file()
        self._close_file()


from openpyxl import Workbook


def main():
    #vedom = parce_vedom()[:]
    #print(vedom)
    #moi
    #vedom = [{'Планировка площадей': {'gsn': '01-02-027-03', 'volume': 0.693, 'units_measurement': '1000 м2'}}, {'Разработка грунта в отвал в котлованах': {'gsn': '01-01-007-03', 'volume': 0.013859999999999999, 'units_measurement': '1000 м3'}}, {'Укладка фундаментов под колонны': {'gsn': '07-01-001-07', 'volume': 0.17325, 'units_measurement': '100 шт'}}, {'Укладка ригелей': {'gsn': '07-01-006-02', 'volume': 0.013859999999999999, 'units_measurement': '100 шт'}}, {'Установка диафрагм жесткости': {'gsn': '07-05-023-06', 'volume': 0.23544, 'units_measurement': '100 шт'}}, {'Установка колонн прямоугольного сечения в стаканы фундаментов зданий': {'gsn': '07-01-011-07', 'volume': 0.43, 'units_measurement': '100 шт'}}, {'Укладка плит перекрытий': {'gsn': '07-01-006-07', 'volume': 1.513542857142857, 'units_measurement': '100 шт'}}, {'Укладка блоков и плит ленточных фундаментов': {'gsn': '07-01-001-04', 'volume': 0.43, 'units_measurement': '100 шт'}}, {'Установка перегородок из гипсовых плит': {'gsn': '08-04-001-01', 'volume': 1.62, 'units_measurement': '100 м2'}}, {'Укладка перемычек': {'gsn': '07-01-021-06', 'volume': 0.62, 'units_measurement': '100 шт'}}, {'Устройство кровель': {'gsn': '12-01-002-01', 'volume': 3.5316, 'units_measurement': '100 м2'}}, {'Устройство лестничных маршей в опалубке': {'gsn': '06-01-111-01', 'volume': 0.02, 'units_measurement': '100 м3'}}, {'Устройство полов бетонных толщиной': {'gsn': '11-01-014-01', 'volume': 3.5316, 'units_measurement': '100 м2'}}, {'Устройство покрытий': {'gsn': '11-01-036-01', 'volume': 3.5316, 'units_measurement': '100 м2'}}, {'Устройство покрытий на цементном растворе из плиток': {'gsn': '11-01-027-02', 'volume': 1.7658, 'units_measurement': '100 м2'}}, {'Установка в жилых и общественных зданиях блоков оконных с переплетами': {'gsn': '10-01-027-01', 'volume': 1.5, 'units_measurement': '100 м2'}}, {'Установка деревянных дверных блоков': {'gsn': '10-04-013-01', 'volume': 1.8, 'units_measurement': '100 м2'}}, {'Установка деревянных подоконных досок в каменных стенах': {'gsn': '10-01-033-02', 'volume': 0.8, 'units_measurement': '100 м2'}}, {'Укладка ригелей': {'gsn': '07-01-006-02', 'volume': 0.24274285714285715, 'units_measurement': '100 шт'}}, {'Установка диафрагм жесткости': {'gsn': '07-05-023-06', 'volume': 0.22655999999999998, 'units_measurement': '100 шт'}}, {'Установка колонн прямоугольного сечения в стаканы фундаментов зданий': {'gsn': '07-01-011-07', 'volume': 0.34, 'units_measurement': '100 шт'}}, {'Укладка плит перекрытий': {'gsn': '07-01-006-07', 'volume': 0.9709714285714286, 'units_measurement': '100 шт'}}, {'Укладка блоков и плит ленточных фундаментов': {'gsn': '07-01-001-04', 'volume': 0.21, 'units_measurement': '100 шт'}}, {'Установка перегородок из гипсовых плит': {'gsn': '08-04-001-01', 'volume': 0.75, 'units_measurement': '100 м2'}}, {'Укладка перемычек': {'gsn': '07-01-021-06', 'volume': 0.3, 'units_measurement': '100 шт'}}, {'Устройство кровель': {'gsn': '12-01-002-01', 'volume': 3.3983999999999996, 'units_measurement': '100 м2'}}, {'Устройство полов бетонных толщиной': {'gsn': '11-01-014-01', 'volume': 3.3983999999999996, 'units_measurement': '100 м2'}}, {'Устройство покрытий': {'gsn': '11-01-036-01', 'volume': 3.3983999999999996, 'units_measurement': '100 м2'}}, {'Устройство покрытий на цементном растворе из плиток': {'gsn': '11-01-027-02', 'volume': 3.3983999999999996, 'units_measurement': '100 м2'}}, {'Установка в жилых и общественных зданиях блоков оконных с переплетами': {'gsn': '10-01-027-01', 'volume': 0.75, 'units_measurement': '100 м2'}}, {'Установка деревянных дверных блоков': {'gsn': '10-04-013-01', 'volume': 0.9, 'units_measurement': '100 м2'}}, {'Установка деревянных подоконных досок в каменных стенах': {'gsn': '10-01-033-02', 'volume': 0.1, 'units_measurement': '100 м2'}}]

    # igor
    vedom = [{'Разработка грунта': {'gsn': '01-01-008-03', 'volume': 3.375, 'units_measurement': '1000 м3 грунта'}}, {'Укладка блоков и плит ленточных фундаментов при глубине котлована до 4 м, масса конструкций: более 3,5 т': {'gsn': '07-01-001-04', 'volume': 1.76, 'units_measurement': '100 шт'}}, {'Укладка фундаментов под колонны при глубине котлована до 4 м, масса конструкций: до 1,5 т': {'gsn': '07-01-001-05', 'volume': 1, 'units_measurement': '100 шт'}}, {'Укладка плит перекрытий площадью: до 5 м2 при наибольшей массе монтажных элементов до 5 т': {'gsn': '07-01-006-04', 'volume': 1.1159999999999999, 'units_measurement': '100 шт'}}, {'Укладка плит покрытий площадью до 2 м2 при массе стропильных и подстропильных конструкций: до 15 т и высоте зданий до 25 м': {'gsn': '07-01-028-07', 'volume': 2.79, 'units_measurement': '100 шт'}}, {'Укладка ригелей массой: до 5 т при наибольшей массе монтажных элементов в здании до 5 т': {'gsn': '07-01-006-01', 'volume': 0.5579999999999999, 'units_measurement': '100 шт'}}, {'Кладка наружных стен из кирпича с облицовкой лицевым кирпичом: толщиной 510 мм при высоте этажа свыше 4 м': {'gsn': '08-02-010-04', 'volume': 463.32, 'units_measurement': '1 м3'}}, {'Кладка перегородок из кирпича: армированных толщиной в 1/4 кирпича при высоте этажа до 4 м': {'gsn': '08-02-002-01', 'volume': 7.1693999999999996, 'units_measurement': '100 м2'}}, {'Установка балок для опирания лестничных площадок при наибольшей массе монтажных элементов в здании до 5 т': {'gsn': '07-01-047-04', 'volume': 0.04, 'units_measurement': '100 шт'}}, {'Установка лестничных площадок при наибольшей массе монтажных элементов в здании до 5 т с опиранием: на стену и балку': {'gsn': '07-01-047-02', 'volume': 0.04, 'units_measurement': '100 шт'}}, {'Установка лестничных маршей при наибольшей массе монтажных элементов в здании до 5 т': {'gsn': '07-01-047-03', 'volume': 0.04, 'units_measurement': '100 шт'}}, {'Устройство полов бетонных толщиной : 200 мм': {'gsn': '11-01-014-03', 'volume': 5.58, 'units_measurement': '100 м2'}}, {'Устройство покрытий на цементном растворе из плиток: керамических для полов одноцветных с красителем': {'gsn': '11-01-027-03', 'volume': 5.58, 'units_measurement': '100 м2'}}, {'Устройство покрытий поливинилацетатных: толщиной 3 мм': {'gsn': '11-01-020-03', 'volume': 5.58, 'units_measurement': '100 м2'}}, {'Остекление оконным стеклом окон: со спаренным переплетом': {'gsn': '15-05-001-04', 'volume': 0.308, 'units_measurement': '100 м2'}}, {'Установка блоков из ПВХ в наружных и внутренних дверных проемах: в каменных стенах площадью проема до 3 м2': {'gsn': '10-01-047-01', 'volume': 0.414, 'units_measurement': '100 м2'}}, {'Улучшенная штукатурка фасадов цементно-известковым раствором по камню: стен': {'gsn': '15-02-001-01', 'volume': 4.0824, 'units_measurement': '100 м2'}}, {'Укладка плит перекрытий площадью: до 5 м2 при наибольшей массе монтажных элементов до 5 т': {'gsn': '07-01-006-04', 'volume': 1.1159999999999999, 'units_measurement': '100 шт'}}, {'Укладка плит покрытий площадью до 2 м2 при массе стропильных и подстропильных конструкций: до 15 т и высоте зданий до 25 м': {'gsn': '07-01-028-07', 'volume': 2.79, 'units_measurement': '100 шт'}}, {'Укладка ригелей массой: до 5 т при наибольшей массе монтажных элементов в здании до 5 т': {'gsn': '07-01-006-01', 'volume': 0.5579999999999999, 'units_measurement': '100 шт'}}, {'Кладка наружных стен из кирпича с облицовкой лицевым кирпичом: толщиной 510 мм при высоте этажа свыше 4 м': {'gsn': '08-02-010-04', 'volume': 408.24, 'units_measurement': '1 м3'}}, {'Кладка перегородок из кирпича: армированных толщиной в 1/4 кирпича при высоте этажа до 4 м': {'gsn': '08-02-002-01', 'volume': 10.092600000000001, 'units_measurement': '100 м2'}}, {'Установка балок для опирания лестничных площадок при наибольшей массе монтажных элементов в здании до 5 т': {'gsn': '07-01-047-04', 'volume': 0.04, 'units_measurement': '100 шт'}}, {'Установка лестничных площадок при наибольшей массе монтажных элементов в здании до 5 т с опиранием: на стену и балку': {'gsn': '07-01-047-02', 'volume': 0.04, 'units_measurement': '100 шт'}}, {'Установка лестничных маршей при наибольшей массе монтажных элементов в здании до 5 т': {'gsn': '07-01-047-03', 'volume': 0.04, 'units_measurement': '100 шт'}}, {'Устройство полов бетонных толщиной : 200 мм': {'gsn': '11-01-014-03', 'volume': 5.58, 'units_measurement': '100 м2'}}, {'Устройство покрытий на цементном растворе из плиток: керамических для полов одноцветных с красителем': {'gsn': '11-01-027-03', 'volume': 5.58, 'units_measurement': '100 м2'}}, {'Устройство покрытий поливинилацетатных: толщиной 3 мм': {'gsn': '11-01-020-03', 'volume': 5.58, 'units_measurement': '100 м2'}}, {'Остекление оконным стеклом окон: со спаренным переплетом': {'gsn': '15-05-001-04', 'volume': 0.26599999999999996, 'units_measurement': '100 м2'}}, {'Установка блоков из ПВХ в наружных и внутренних дверных проемах: в каменных стенах площадью проема до 3 м2': {'gsn': '10-01-047-01', 'volume': 0.342, 'units_measurement': '100 м2'}}, {'Улучшенная штукатурка фасадов цементно-известковым раствором по камню: стен': {'gsn': '15-02-001-01', 'volume': 4.0824, 'units_measurement': '100 м2'}}, {'Укладка плит перекрытий площадью: до 5 м2 при наибольшей массе монтажных элементов до 5 т': {'gsn': '07-01-006-04', 'volume': 0.8928, 'units_measurement': '100 шт'}}, {'Укладка плит покрытий площадью до 2 м2 при массе стропильных и подстропильных конструкций: до 15 т и высоте зданий до 25 м': {'gsn': '07-01-028-07', 'volume': 2.232, 'units_measurement': '100 шт'}}, {'Укладка ригелей массой: до 5 т при наибольшей массе монтажных элементов в здании до 5 т': {'gsn': '07-01-006-01', 'volume': 0.5579999999999999, 'units_measurement': '100 шт'}}, {'Кладка наружных стен из кирпича с облицовкой лицевым кирпичом: толщиной 510 мм при высоте этажа свыше 4 м': {'gsn': '08-02-010-04', 'volume': 412.92, 'units_measurement': '1 м3'}}, {'Кладка перегородок из кирпича: армированных толщиной в 1/4 кирпича при высоте этажа до 4 м': {'gsn': '08-02-002-01', 'volume': 8.068200000000001, 'units_measurement': '100 м2'}}, {'Установка балок для опирания лестничных площадок при наибольшей массе монтажных элементов в здании до 5 т': {'gsn': '07-01-047-04', 'volume': 0.04, 'units_measurement': '100 шт'}}, {'Установка лестничных площадок при наибольшей массе монтажных элементов в здании до 5 т с опиранием: на стену и балку': {'gsn': '07-01-047-02', 'volume': 0.04, 'units_measurement': '100 шт'}}, {'Установка лестничных маршей при наибольшей массе монтажных элементов в здании до 5 т': {'gsn': '07-01-047-03', 'volume': 0.04, 'units_measurement': '100 шт'}}, {'Устройство полов бетонных толщиной : 200 мм': {'gsn': '11-01-014-03', 'volume': 4.464, 'units_measurement': '100 м2'}}, {'Устройство покрытий на цементном растворе из плиток: керамических для полов одноцветных с красителем': {'gsn': '11-01-027-03', 'volume': 4.464, 'units_measurement': '100 м2'}}, {'Устройство покрытий поливинилацетатных: толщиной 3 мм': {'gsn': '11-01-020-03', 'volume': 4.464, 'units_measurement': '100 м2'}}, {'Остекление оконным стеклом окон: со спаренным переплетом': {'gsn': '15-05-001-04', 'volume': 0.28, 'units_measurement': '100 м2'}}, {'Установка блоков из ПВХ в наружных и внутренних дверных проемах: в каменных стенах площадью проема до 3 м2': {'gsn': '10-01-047-01', 'volume': 0.198, 'units_measurement': '100 м2'}}, {'Улучшенная штукатурка фасадов цементно-известковым раствором по камню: стен': {'gsn': '15-02-001-01', 'volume': 3.5784000000000002, 'units_measurement': '100 м2'}}, {'Устройство кровель плоских четырехслойных из рулонных кровельных материалов на битумной мастике: с защитным слоем из гравия на битумной антисептированной мастике': {'gsn': '12-01-002-01', 'volume': 15.8286, 'units_measurement': '100 м2 кровли'}}]
    # vlad
    # vedom = [{'Планировка площадей': {'gsn': '01-02-027-03', 'volume': 1.239, 'units_measurement': '1000 м2'}}, {'Разработка грунта': {'gsn': '01-01-008-03', 'volume': 0.02478, 'units_measurement': '1000 м3'}}, {'Устройство ленточных фундаментов': {'gsn': '06-01-001-20', 'volume': 3.4935, 'units_measurement': '100 м3'}}, {'Укладка плит перекрытия': {'gsn': '07-01-006-06', 'volume': 0.16803333333333334, 'units_measurement': '100 шт'}}, {'Устройство стен бетонных до 3 м': {'gsn': '06-01-031-05', 'volume': 0.35, 'units_measurement': '100 м3'}}, {'Устройство жб стен и перегородок высотой 6м/ 300мм': {'gsn': '06-01-031-14', 'volume': 0.27, 'units_measurement': '100 м3'}}, {'Устройство жб стен и перегородок высотой 6м/ 500мм': {'gsn': '06-01-031-15', 'volume': 0.10467, 'units_measurement': '100 м3'}}, {'Кладка перегородок из кирпича': {'gsn': '08-02-002-04', 'volume': 2.95, 'units_measurement': '100 м2'}}, {'Устройство перегородок из гипсокартона': {'gsn': '10-05-001-02', 'volume': 2.95, 'units_measurement': '100 м2'}}, {'Укладка перемычек': {'gsn': '07-01-021-01', 'volume': 0.29, 'units_measurement': '100 шт'}}, {'Устройство кровель плоских': {'gsn': '12-01-002-07', 'volume': 4.172, 'units_measurement': '100 м2'}}, {'Устройство лестник и площадок': {'gsn': '29-01-216-01', 'volume': 0.099, 'units_measurement': '100 м3'}}, {'Устройство покрытия из ленолиума': {'gsn': '11-01-036-01', 'volume': 3.8560000000000003, 'units_measurement': '100 м2'}}, {'Устройство покрытий мозаичных': {'gsn': '11-01-017-02', 'volume': 0.38299999999999995, 'units_measurement': '100 м2'}}, {'Монтаж оконных блоков': {'gsn': '09-04-009-04', 'volume': 0.16, 'units_measurement': '100 м2'}}, {'Остекленение оконным стеклом окон': {'gsn': '15-05-001-04', 'volume': 0.16, 'units_measurement': '100 м2'}}, {'Установка дверных блоков': {'gsn': '10-04-013-01', 'volume': 0.84, 'units_measurement': '100 м2'}}, {'Укладка плит перекрытия': {'gsn': '07-01-006-06', 'volume': 0.11199999999999999, 'units_measurement': '100 шт'}}, {'Устройство жб стен и перегородок высотой 6м/ 300мм': {'gsn': '06-01-031-14', 'volume': 0.4608, 'units_measurement': '100 м3'}}, {'Устройство жб стен и перегородок высотой 6м/ 500мм': {'gsn': '06-01-031-15', 'volume': 1.11, 'units_measurement': '100 м3'}}, {'Кладка перегородок из кирпича': {'gsn': '08-02-002-04', 'volume': 2.256, 'units_measurement': '100 м2'}}, {'Устройство перегородок из гипсокартона': {'gsn': '10-05-001-02', 'volume': 2.256, 'units_measurement': '100 м2'}}, {'Укладка перемычек': {'gsn': '07-01-021-01', 'volume': 0.3, 'units_measurement': '100 шт'}}, {'Устройство кровель плоских': {'gsn': '12-01-002-07', 'volume': 3.713, 'units_measurement': '100 м2'}}, {'Устройство лестник и площадок': {'gsn': '29-01-216-01', 'volume': 0.13, 'units_measurement': '100 м3'}}, {'Устройство покрытия из ленолиума': {'gsn': '11-01-036-01', 'volume': 0.483, 'units_measurement': '100 м2'}}, {'Устройство покрытия из паркета': {'gsn': '11-01-034-03', 'volume': 2.3280000000000003, 'units_measurement': '100 м2'}}, {'Устройство покрытия из плиток': {'gsn': '11-01-027-03', 'volume': 0.442, 'units_measurement': '100 м2'}}, {'Монтаж оконных блоков': {'gsn': '09-04-009-04', 'volume': 0.24, 'units_measurement': '100 м2'}}, {'Остекленение оконным стеклом окон': {'gsn': '15-05-001-04', 'volume': 0.24, 'units_measurement': '100 м2'}}, {'Установка дверных блоков': {'gsn': '10-04-013-01', 'volume': 0.46, 'units_measurement': '100 м2'}}]

    count_vedom = len(vedom)
    gsns = []
    for w in vedom:
        for g in w.values():
            gsns.append(g['gsn'])
    #resources_defsmeta = parce_defsmeta(set(gsns))
    #print(resources_defsmeta)
    # moi
    #resources_defsmeta ={'01-01-007-03': [{'name': 'Экскаваторы одноковшовые дизельные на гусеничном ходу при работе на других видах строительства 0,5 м3', 'consumption': 40.71, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 40.71, 'type': 'people', 'unit': 'чел.-ч'}], '08-04-001-01': [{'name': 'Гвозди проволочные круглые формовочные 1,6х100 мм', 'consumption': 0.0004, 'type': 'material', 'unit': 'т'}, {'name': 'Поковки из квадратных заготовок, масса 1,8 кг', 'consumption': 0.008, 'type': 'material', 'unit': 'т'}, {'name': 'Толь с крупнозернистой посыпкой марки ТВК-350', 'consumption': 6.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Плиты гипсовые толщиной до 100 мм', 'consumption': 91.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Бруски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 40-75 мм, III сорта', 'consumption': 0.1, 'type': 'material', 'unit': 'м3'}, {'name': 'Горячекатаная арматурная сталь класс а А-I', 'consumption': 0.013, 'type': 'material', 'unit': 'т'}, {'name': 'Гипсовые вяжущие, марка Г3', 'consumption': 0.57, 'type': 'material', 'unit': 'т'}, {'name': 'Песок для строительных работ природный', 'consumption': 0.6, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 0.24, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 2.14, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 1.07, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,6', 'consumption': 96.83, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 2.14, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-001-07': [{'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Песок для строительных работ природный', 'consumption': 39.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 25 т', 'consumption': 85.56, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 4.35, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Компрессоры передвижные с двигателем внутреннего сгорания давлением до 686 кПа(7 ат), производительность 5 м3/мин', 'consumption': 1.21, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Трамбовки пневматические при работе от передвижных компрессорных станций', 'consumption': 4.81, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Тягачи седельные, грузоподъемность 15 т', 'consumption': 17.0, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Полуприцепы-тяжеловозы, грузоподъемность 40 т', 'consumption': 17.0, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,4', 'consumption': 308.58, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 91.12, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-011-07': [{'name': 'Доски обрезные хвойных пород длиной 2-3,75 м, шириной 75-150 мм, толщиной 44 мм и более, II сорта', 'consumption': 0.32, 'type': 'material', 'unit': 'м3'}, {'name': 'Бетон', 'consumption': 10.8, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 25 т', 'consumption': 176.65, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор глубинный', 'consumption': 9.07, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.2, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Тягачи седельные, грузоподъемность 15 т', 'consumption': 37.43, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Полуприцепы-тяжеловозы, грузоподъемность 40 т', 'consumption': 37.43, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,7', 'consumption': 1254.3, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 176.65, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-021-06': [{'name': 'Раствор готовый кладочный цементный марки 50', 'consumption': 0.33, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны башенные при работе на других видах строительства 10 т', 'consumption': 43.17, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 112.69, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 43.17, 'type': 'people', 'unit': 'чел.-ч'}], '01-02-027-03': [{'name': 'Бульдозеры при работе на других видах строительства 79 кВт (108 л.с.)', 'consumption': 0.98, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автогрейдеры среднего типа 99 кВт(135 л.с.)', 'consumption': 0.51, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 1.49, 'type': 'people', 'unit': 'чел.-ч'}], '11-01-014-01': [{'name': 'Доски обрезные хвойных пород длиной 2-3,75 м, шириной 75-150 мм, толщиной 25 мм, IV сорта', 'consumption': 0.06, 'type': 'material', 'unit': 'м3'}, {'name': 'Бетон тяжелый', 'consumption': 10.2, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 0.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Комплексы вакуумные типа СО-177', 'consumption': 11.02, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 4', 'consumption': 30.3, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 11.02, 'type': 'people', 'unit': 'чел.-ч'}], '11-01-036-01': [{'name': 'Клей <Бустилат>', 'consumption': 0.05, 'type': 'material', 'unit': 'т'}, {'name': 'Ветошь', 'consumption': 0.5, 'type': 'material', 'unit': 'кг'}, {'name': 'Линолеум на теплозвукоизолирующей подоснове', 'consumption': 102.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Подъемники грузоподъемностью до 500 кг одномачтовые, высота подъема 45 м', 'consumption': 0.35, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.5, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 2,7', 'consumption': 42.4, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.35, 'type': 'people', 'unit': 'чел.-ч'}], '10-01-027-01': [{'name': 'Гвозди толевые круглые 3,0х40 мм', 'consumption': 0.0028, 'type': 'material', 'unit': 'т'}, {'name': 'Смола каменноугольная для дорожного строительства', 'consumption': 0.031, 'type': 'material', 'unit': 'т'}, {'name': 'Толь с крупнозернистой посыпкой гидроизоляционный марки ТГ-350', 'consumption': 118.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Гвозди строительные', 'consumption': 0.00296, 'type': 'material', 'unit': 'т'}, {'name': 'Пена монтажная', 'consumption': 51.9, 'type': 'material', 'unit': 'л'}, {'name': 'Скобяные изделия', 'consumption': 0.0, 'type': 'material', 'unit': 'компл.'}, {'name': 'Шурупы строительные', 'consumption': 0.0114, 'type': 'material', 'unit': 'т'}, {'name': 'Блоки оконные', 'consumption': 100.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Раствор готовый отделочный тяжелый, известковый 1:2,0', 'consumption': 0.138, 'type': 'material', 'unit': 'м3'}, {'name': 'Гипсовые вяжущие, марка Г3', 'consumption': 0.0298, 'type': 'material', 'unit': 'т'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 5.31, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 1.48, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Котлы битумные передвижные 400 л', 'consumption': 2.38, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Шуруповерт', 'consumption': 10.17, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 2.22, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,4', 'consumption': 188.6, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 6.79, 'type': 'people', 'unit': 'чел.-ч'}], '12-01-002-01': [{'name': 'Мастика битумная кровельная горячая', 'consumption': 1.26, 'type': 'material', 'unit': 'т'}, {'name': 'Материалы рулонные кровельные', 'consumption': 460.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Симазин 50%-ный порошок смачивающийся', 'consumption': 0.001, 'type': 'material', 'unit': 'т'}, {'name': 'Гравий для строительных работ, фракция 5 -10 мм', 'consumption': 1.05, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 0.44, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 0.25, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 0.13, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Котлы битумные передвижные 400 л', 'consumption': 10.29, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.36, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,8', 'consumption': 29.72, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.82, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-006-07': [{'name': 'Проволока горячекатаная в мотках, диаметром 6,3-6,5 мм', 'consumption': 0.041, 'type': 'material', 'unit': 'т'}, {'name': 'Рубероид подкладочный с пылевидной посыпкой РПП-300б', 'consumption': 98.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Смазка солидол жировой марки <Ж>', 'consumption': 0.009, 'type': 'material', 'unit': 'т'}, {'name': 'Электроды диаметром 6 мм Э42', 'consumption': 0.03, 'type': 'material', 'unit': 'т'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 32-40 мм, IV сорта', 'consumption': 0.848, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструктивные элементы вспомогательного назначения с преобладанием профильного проката собираемые из двух и более деталей, с отверстиями и без отверстий, соединяемые на сварке', 'consumption': 0.26, 'type': 'material', 'unit': 'т'}, {'name': 'Горячекатаная арматурная сталь гладкая класса А-I, диаметром 14 мм', 'consumption': 0.02, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон', 'consumption': 21.0, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 40 т', 'consumption': 31.98, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 9.48, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 12.37, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,6', 'consumption': 223.11, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 31.98, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-001-04': [{'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Песок для строительных работ природный', 'consumption': 39.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 25 т', 'consumption': 44.82, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 4.35, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Компрессоры передвижные с двигателем внутреннего сгорания давлением до 686 кПа(7 ат), производительность 5 м3/мин', 'consumption': 1.21, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Трамбовки пневматические при работе от стационарного компрессора', 'consumption': 4.81, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Тягачи седельные, грузоподъемность 15 т', 'consumption': 14.03, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Полуприцепы-тяжеловозы, грузоподъемность 40 т', 'consumption': 14.03, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,6', 'consumption': 186.48, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 50.38, 'type': 'people', 'unit': 'чел.-ч'}], '11-01-027-02': [{'name': 'Опилки древесные', 'consumption': 3.06, 'type': 'material', 'unit': 'м3'}, {'name': 'Плитки керамические для полов гладкие неглазурованные многоцветные квадратные и прямоугольные', 'consumption': 102.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Раствор готовый кладочный тяжелый цементный', 'consumption': 1.3, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 3.85, 'type': 'material', 'unit': 'м3'}, {'name': 'Автопогрузчики 5 т', 'consumption': 0.36, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Подъемники грузоподъемностью до 500 кг одномачтовые, высота подъема 45 м', 'consumption': 2.3, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.28, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 119.78, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 2.66, 'type': 'people', 'unit': 'чел.-ч'}], '10-01-033-02': [{'name': 'Смола каменноугольная для дорожного строительства', 'consumption': 0.006, 'type': 'material', 'unit': 'т'}, {'name': 'Войлок строительный', 'consumption': 0.052, 'type': 'material', 'unit': 'т'}, {'name': 'Толь с крупнозернистой посыпкой гидроизоляционный марки ТГ-350', 'consumption': 5.58, 'type': 'material', 'unit': 'м2'}, {'name': 'Гвозди строительные', 'consumption': 0.0056, 'type': 'material', 'unit': 'т'}, {'name': 'Натрий фтористый технический, марка А, сорт I', 'consumption': 0.0007, 'type': 'material', 'unit': 'т'}, {'name': 'Доски подоконные деревянные', 'consumption': 74.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Раствор готовый отделочный тяжелый, известковый 1:3', 'consumption': 0.34, 'type': 'material', 'unit': 'м3'}, {'name': 'Гипсовые вяжущие, марка Г3', 'consumption': 0.3, 'type': 'material', 'unit': 'т'}, {'name': 'Вода', 'consumption': 0.6, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 0.2, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Котлы битумные передвижные 400 л', 'consumption': 1.0, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.27, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,1', 'consumption': 66.22, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.2, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-006-02': [{'name': 'Проволока горячекатаная в мотках, диаметром 6,3-6,5 мм', 'consumption': 0.008, 'type': 'material', 'unit': 'т'}, {'name': 'Смазка солидол жировой марки <Ж>', 'consumption': 0.0096, 'type': 'material', 'unit': 'т'}, {'name': 'Электроды диаметром 6 мм Э42', 'consumption': 0.08, 'type': 'material', 'unit': 'т'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 32-40 мм, IV сорта', 'consumption': 0.166, 'type': 'material', 'unit': 'м3'}, {'name': 'Бетон', 'consumption': 1.73, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 40 т', 'consumption': 76.28, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 22.58, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор глубинный', 'consumption': 1.46, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.2, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Тягачи седельные, грузоподъемность 15 т', 'consumption': 19.86, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Полуприцепы-тяжеловозы, грузоподъемность 40 т', 'consumption': 19.86, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,8', 'consumption': 404.04, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 76.28, 'type': 'people', 'unit': 'чел.-ч'}], '10-04-013-01': [{'name': 'Гвозди строительные', 'consumption': 0.0034, 'type': 'material', 'unit': 'т'}, {'name': 'Скобяные изделия', 'consumption': 0.0, 'type': 'material', 'unit': 'компл.'}, {'name': 'Блоки дверные', 'consumption': 100.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 1.37, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 2.06, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 73.14, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 1.37, 'type': 'people', 'unit': 'чел.-ч'}], '07-05-023-06': [{'name': 'Ацетилен растворенный технический марки А', 'consumption': 0.001, 'type': 'material', 'unit': 'т'}, {'name': 'Кислород технический газообразный', 'consumption': 5.2, 'type': 'material', 'unit': 'м3'}, {'name': 'Поковки из квадратных заготовок, масса 2,825 кг', 'consumption': 0.007, 'type': 'material', 'unit': 'т'}, {'name': 'Проволока наплавочная диаметром 3 мм ПП-Нп-19СТ', 'consumption': 0.012, 'type': 'material', 'unit': 'т'}, {'name': 'Электроды диаметром 6 мм Э42', 'consumption': 0.22, 'type': 'material', 'unit': 'т'}, {'name': 'Болты с гайками и шайбами строительные', 'consumption': 0.0728, 'type': 'material', 'unit': 'т'}, {'name': 'Гвозди строительные', 'consumption': 0.00941, 'type': 'material', 'unit': 'т'}, {'name': 'Лесоматериалы круглые хвойных пород для выработки пиломатериалов и заготовок (пластины) толщиной 20-24 см, III сорта', 'consumption': 0.31, 'type': 'material', 'unit': 'м3'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 44 мм и более, II сорта', 'consumption': 1.17, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструктивные элементы вспомогательного назначения с преобладанием профильного проката собираемые из двух и более деталей, с отверстиями и без отверстий, соединяемые на сварке', 'consumption': 3.45, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон', 'consumption': 21.1, 'type': 'material', 'unit': 'м3'}, {'name': 'Раствор готовый кладочный цементный марки 200', 'consumption': 1.87, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 167.36, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 134.92, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Аппарат для газовой сварки и резки', 'consumption': 5.12, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор глубинный', 'consumption': 18.84, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 8.35, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 4,2', 'consumption': 1254.34, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 167.36, 'type': 'people', 'unit': 'чел.-ч'}], '06-01-111-01': [{'name': 'Масла антраценовые', 'consumption': 0.173, 'type': 'material', 'unit': 'т'}, {'name': 'Проволока светлая диаметром 1,1 мм', 'consumption': 0.0236, 'type': 'material', 'unit': 'т'}, {'name': 'Электроды диаметром 4 мм Э42', 'consumption': 0.013, 'type': 'material', 'unit': 'т'}, {'name': 'Рогожа', 'consumption': 42.9, 'type': 'material', 'unit': 'м2'}, {'name': 'Гвозди строительные', 'consumption': 0.015, 'type': 'material', 'unit': 'т'}, {'name': 'Опалубка переставная(амортизация)', 'consumption': 0.0, 'type': 'material', 'unit': 'компл.'}, {'name': 'Опалубка типа<Дока> (конструкции металлические)', 'consumption': 0.0, 'type': 'material', 'unit': 'компл.'}, {'name': 'Палуба опалубки типа<Дока> из бакелизированной фанеры', 'consumption': 29.2, 'type': 'material', 'unit': 'м2'}, {'name': 'Бруски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 40-75 мм, III сорта', 'consumption': 0.82, 'type': 'material', 'unit': 'м3'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 25 мм, III сорта', 'consumption': 0.26, 'type': 'material', 'unit': 'м3'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 44 мм и более, III сорта', 'consumption': 1.02, 'type': 'material', 'unit': 'м3'}, {'name': 'Арматура', 'consumption': 15.7, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон тяжелый', 'consumption': 101.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 0.2066, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 51.7, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 2.35, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 2.54, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 13.2, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор поверхностный', 'consumption': 78.0, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Пила цепная электрическая', 'consumption': 1.21, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 8 т', 'consumption': 3.53, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,1', 'consumption': 2412.6, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 56.59, 'type': 'people', 'unit': 'чел.-ч'}]}
    # igor
    resources_defsmeta = {'11-01-020-03': [{'name': 'Краски масляные и алкидные земляные, готовые к применению сурик железный МА-15, ПФ-14', 'consumption': 0.0002, 'type': 'material', 'unit': 'т'}, {'name': 'Краски масляные и алкидные земляные, готовые к применению охра МА-15', 'consumption': 0.0068, 'type': 'material', 'unit': 'т'}, {'name': 'Портландцемент общестроительного назначения бездобавочный, марки 400', 'consumption': 0.013, 'type': 'material', 'unit': 'т'}, {'name': 'Смола каменноугольная для дорожного строительства', 'consumption': 0.036, 'type': 'material', 'unit': 'т'}, {'name': 'Кислота ортофосфорная техническая, сорт I', 'consumption': 0.0078, 'type': 'material', 'unit': 'т'}, {'name': 'Дисперсия поливинилацетатная непластифицированная марки Д50Н', 'consumption': 219.0, 'type': 'material', 'unit': 'кг'}, {'name': 'Маршалит', 'consumption': 0.272, 'type': 'material', 'unit': 'т'}, {'name': 'Песок для строительных работ природный', 'consumption': 0.0173, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 0.135, 'type': 'material', 'unit': 'м3'}, {'name': 'Подъемники грузоподъемностью до 500 кг одномачтовые, высота подъема 45 м', 'consumption': 0.18, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Растворосмесители передвижные 250 л', 'consumption': 7.56, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.27, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 2,8', 'consumption': 77.26, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 7.74, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-006-01': [{'name': 'Проволока горячекатаная в мотках, диаметром 6,3-6,5 мм', 'consumption': 0.008, 'type': 'material', 'unit': 'т'}, {'name': 'Смазка солидол жировой марки <Ж>', 'consumption': 0.0096, 'type': 'material', 'unit': 'т'}, {'name': 'Электроды диаметром 6 мм Э42', 'consumption': 0.08, 'type': 'material', 'unit': 'т'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 32-40 мм, IV сорта', 'consumption': 0.166, 'type': 'material', 'unit': 'м3'}, {'name': 'Бетон', 'consumption': 1.73, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 25 т', 'consumption': 76.28, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 22.58, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор глубинный', 'consumption': 1.46, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.2, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Тягачи седельные, грузоподъемность 15 т', 'consumption': 19.86, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Полуприцепы-тяжеловозы, грузоподъемность 40 т', 'consumption': 19.86, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,8', 'consumption': 404.04, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 76.28, 'type': 'people', 'unit': 'чел.-ч'}], '15-05-001-04': [{'name': 'Замазка оконная на олифе', 'consumption': 0.063, 'type': 'material', 'unit': 'т'}, {'name': 'Мыло твердое хозяйственное 72%', 'consumption': 1.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Олифа комбинированная, марки К-2', 'consumption': 0.0022, 'type': 'material', 'unit': 'т'}, {'name': 'Ветошь', 'consumption': 0.2, 'type': 'material', 'unit': 'кг'}, {'name': 'Стекло оконное', 'consumption': 157.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 0.33, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.46, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3', 'consumption': 51.08, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.33, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-001-05': [{'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Песок для строительных работ природный', 'consumption': 22.0, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства до 16 т', 'consumption': 42.72, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 2.42, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Компрессоры передвижные с двигателем внутреннего сгорания давлением до 686 кПа(7 ат), производительность 5 м3/мин', 'consumption': 7.63, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Трамбовки пневматические при работе от передвижных компрессорных станций', 'consumption': 2.68, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 5.13, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,3', 'consumption': 135.52, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 52.77, 'type': 'people', 'unit': 'чел.-ч'}], '15-02-001-01': [{'name': 'Раствор готовый отделочный тяжелый, цементно-известковый 1:1:6', 'consumption': 1.89, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 0.35, 'type': 'material', 'unit': 'м3'}, {'name': 'Лебедки электрические тяговым усилием до 12,26 кН(1,25 т)', 'consumption': 0.9, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Растворонасосы 3 м3/ч', 'consumption': 2.78, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 4', 'consumption': 70.88, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 2.78, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-047-03': [{'name': 'Электроды диаметром 6 мм Э42', 'consumption': 0.008, 'type': 'material', 'unit': 'т'}, {'name': 'Краска', 'consumption': 0.0032, 'type': 'material', 'unit': 'т'}, {'name': 'Конструктивные элементы вспомогательного назначения с преобладанием профильного проката собираемые из двух и более деталей, с отверстиями и без отверстий, соединяемые на сварке', 'consumption': 0.2, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон', 'consumption': 0.52, 'type': 'material', 'unit': 'м3'}, {'name': 'Раствор готовый кладочный цементный марки 100', 'consumption': 0.6, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 82.25, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 9.52, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 1.05, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,4', 'consumption': 347.48, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 82.25, 'type': 'people', 'unit': 'чел.-ч'}], '01-01-008-03': [{'name': 'Экскаваторы одноковшовые дизельные на гусеничном ходу при работе на других видах строительства 0,65 м3', 'consumption': 33.63, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 33.63, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-001-04': [{'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Песок для строительных работ природный', 'consumption': 39.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 25 т', 'consumption': 44.82, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 4.35, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Компрессоры передвижные с двигателем внутреннего сгорания давлением до 686 кПа(7 ат), производительность 5 м3/мин', 'consumption': 1.21, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Трамбовки пневматические при работе от стационарного компрессора', 'consumption': 4.81, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Тягачи седельные, грузоподъемность 15 т', 'consumption': 14.03, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Полуприцепы-тяжеловозы, грузоподъемность 40 т', 'consumption': 14.03, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,6', 'consumption': 186.48, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 50.38, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-028-07': [{'name': 'Раствор готовый кладочный цементный марки 100', 'consumption': 0.46, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 25 т', 'consumption': 9.6, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,3', 'consumption': 63.39, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 9.6, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-006-04': [{'name': 'Проволока горячекатаная в мотках, диаметром 6,3-6,5 мм', 'consumption': 0.035, 'type': 'material', 'unit': 'т'}, {'name': 'Рубероид подкладочный с пылевидной посыпкой РПП-300б', 'consumption': 84.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Смазка солидол жировой марки <Ж>', 'consumption': 0.0045, 'type': 'material', 'unit': 'т'}, {'name': 'Электроды диаметром 6 мм Э42', 'consumption': 0.02, 'type': 'material', 'unit': 'т'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 32-40 мм, IV сорта', 'consumption': 0.736, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструктивные элементы вспомогательного назначения с преобладанием профильного проката собираемые из двух и более деталей, с отверстиями и без отверстий, соединяемые на сварке', 'consumption': 0.13, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон', 'consumption': 15.7, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 25 т', 'consumption': 25.03, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 5.96, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 8.21, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,5', 'consumption': 169.83, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 25.03, 'type': 'people', 'unit': 'чел.-ч'}], '08-02-010-04': [{'name': 'Бруски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 40-75 мм, IV сорта', 'consumption': 0.0005, 'type': 'material', 'unit': 'м3'}, {'name': 'Раствор готовый кладочный', 'consumption': 0.242, 'type': 'material', 'unit': 'м3'}, {'name': 'Кирпич керамический, силикатный или пустотелый', 'consumption': 0.265, 'type': 'material', 'unit': '1000 шт.'}, {'name': 'Кирпич керамический или силикатный лицевой', 'consumption': 0.134, 'type': 'material', 'unit': '1000 шт.'}, {'name': 'Вода', 'consumption': 0.35, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 0.25, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 6.55, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.25, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-047-04': [{'name': 'Раствор готовый кладочный цементный марки 100', 'consumption': 0.09, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 50.18, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,6', 'consumption': 218.96, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 50.18, 'type': 'people', 'unit': 'чел.-ч'}], '11-01-027-03': [{'name': 'Плитки керамические для полов гладкие неглазурованные одноцветные с красителем квадратные и прямоугольные', 'consumption': 102.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Опилки древесные', 'consumption': 3.06, 'type': 'material', 'unit': 'м3'}, {'name': 'Раствор готовый кладочный тяжелый цементный', 'consumption': 1.3, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 3.85, 'type': 'material', 'unit': 'м3'}, {'name': 'Автопогрузчики 5 т', 'consumption': 0.36, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Подъемники грузоподъемностью до 500 кг одномачтовые, высота подъема 45 м', 'consumption': 2.3, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.28, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 119.78, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 2.66, 'type': 'people', 'unit': 'чел.-ч'}], '12-01-002-01': [{'name': 'Мастика битумная кровельная горячая', 'consumption': 1.26, 'type': 'material', 'unit': 'т'}, {'name': 'Материалы рулонные кровельные', 'consumption': 460.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Симазин 50%-ный порошок смачивающийся', 'consumption': 0.001, 'type': 'material', 'unit': 'т'}, {'name': 'Гравий для строительных работ, фракция 5 -10 мм', 'consumption': 1.05, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 0.44, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 0.25, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 0.13, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Котлы битумные передвижные 400 л', 'consumption': 10.29, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.36, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,8', 'consumption': 29.72, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.82, 'type': 'people', 'unit': 'чел.-ч'}], '10-01-047-01': [{'name': 'Лента бутиловая', 'consumption': 402.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Лента бутиловая диффузионная', 'consumption': 43.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Герметик пенополиуретановый (пена монтажная) типа Makrofleks, Soudal в баллонах по 750 мл', 'consumption': 123.5, 'type': 'material', 'unit': 'шт.'}, {'name': 'Лента ПСУЛ', 'consumption': 293.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Дюбели монтажные 10х130 (10х132, 10х150) мм', 'consumption': 65.2, 'type': 'material', 'unit': '10 шт.'}, {'name': 'Клинья пластиковые монтажные', 'consumption': 800.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Блоки дверные входные пластиковые', 'consumption': 100.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Подъемники грузоподъемностью до 500 кг одномачтовые, высота подъема 45 м', 'consumption': 1.05, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Шуруповерт', 'consumption': 20.91, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Перфораторы электрические', 'consumption': 32.21, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 3.57, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,3', 'consumption': 201.0, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 1.05, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-047-02': [{'name': 'Электроды диаметром 6 мм Э42', 'consumption': 0.011, 'type': 'material', 'unit': 'т'}, {'name': 'Конструктивные элементы вспомогательного назначения с преобладанием профильного проката собираемые из двух и более деталей, с отверстиями и без отверстий, соединяемые на сварке', 'consumption': 0.2, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон', 'consumption': 0.47, 'type': 'material', 'unit': 'м3'}, {'name': 'Раствор готовый кладочный цементный марки 100', 'consumption': 0.55, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 54.72, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 13.09, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.9, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,7', 'consumption': 286.79, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 54.72, 'type': 'people', 'unit': 'чел.-ч'}], '08-02-002-01': [{'name': 'Поковки из квадратных заготовок, масса 1,8 кг', 'consumption': 0.0023, 'type': 'material', 'unit': 'т'}, {'name': 'Бруски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 40-75 мм, IV сорта', 'consumption': 0.008, 'type': 'material', 'unit': 'м3'}, {'name': 'Горячекатаная арматурная сталь класс а А-I', 'consumption': 0.06, 'type': 'material', 'unit': 'т'}, {'name': 'Раствор готовый кладочный', 'consumption': 0.83, 'type': 'material', 'unit': 'м3'}, {'name': 'Кирпич керамический, силикатный или пустотелый', 'consumption': 2.94, 'type': 'material', 'unit': '1000 шт.'}, {'name': 'Вода', 'consumption': 0.1, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 2.15, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.11, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3', 'consumption': 146.32, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 2.15, 'type': 'people', 'unit': 'чел.-ч'}], '11-01-014-03': [{'name': 'Доски обрезные хвойных пород длиной 2-3,75 м, шириной 75-150 мм, толщиной 25 мм, IV сорта', 'consumption': 0.15, 'type': 'material', 'unit': 'м3'}, {'name': 'Бетон тяжелый', 'consumption': 20.4, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 0.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Комплексы вакуумные типа СО-177', 'consumption': 12.76, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 4', 'consumption': 36.0, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 12.76, 'type': 'people', 'unit': 'чел.-ч'}]}
    # vlad
    # resources_defsmeta ={'08-02-002-04': [{'name': 'Поковки из квадратных заготовок, масса 1,8 кг', 'consumption': 0.0023, 'type': 'material', 'unit': 'т'}, {'name': 'Бруски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 40-75 мм, IV сорта', 'consumption': 0.016, 'type': 'material', 'unit': 'м3'}, {'name': 'Горячекатаная арматурная сталь класс а А-I', 'consumption': 0.09, 'type': 'material', 'unit': 'т'}, {'name': 'Раствор готовый кладочный', 'consumption': 2.3, 'type': 'material', 'unit': 'м3'}, {'name': 'Кирпич керамический, силикатный или пустотелый', 'consumption': 5.04, 'type': 'material', 'unit': '1000 шт.'}, {'name': 'Вода', 'consumption': 0.3, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 4.11, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.11, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3', 'consumption': 135.66, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 4.11, 'type': 'people', 'unit': 'чел.-ч'}], '12-01-002-07': [{'name': 'Мастика битумно-полимерная', 'consumption': 0.77, 'type': 'material', 'unit': 'т'}, {'name': 'Материалы рулонные кровельные для верхнего слоя', 'consumption': 126.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Материалы рулонные кровельные для нижних слоев', 'consumption': 250.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 0.24, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 0.09, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Котлы битумные передвижные 400 л', 'consumption': 6.38, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.14, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,8', 'consumption': 26.22, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.33, 'type': 'people', 'unit': 'чел.-ч'}], '11-01-036-01': [{'name': 'Клей <Бустилат>', 'consumption': 0.05, 'type': 'material', 'unit': 'т'}, {'name': 'Ветошь', 'consumption': 0.5, 'type': 'material', 'unit': 'кг'}, {'name': 'Линолеум на теплозвукоизолирующей подоснове', 'consumption': 102.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Подъемники грузоподъемностью до 500 кг одномачтовые, высота подъема 45 м', 'consumption': 0.35, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.5, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 2,7', 'consumption': 42.4, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.35, 'type': 'people', 'unit': 'чел.-ч'}], '29-01-216-01': [{'name': 'Поковки из квадратных заготовок, масса 1,8 кг', 'consumption': 0.03, 'type': 'material', 'unit': 'т'}, {'name': 'Электроды диаметром 4 мм Э42', 'consumption': 0.00274, 'type': 'material', 'unit': 'т'}, {'name': 'Гвозди строительные', 'consumption': 0.0784, 'type': 'material', 'unit': 'т'}, {'name': 'Стойки рудничные длиной 2,5-3,9 м', 'consumption': 5.82, 'type': 'material', 'unit': 'м3'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 25 мм, II сорта', 'consumption': 1.57, 'type': 'material', 'unit': 'м3'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 44 мм и более, II сорта', 'consumption': 21.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Арматура', 'consumption': 0.0, 'type': 'material', 'unit': 'т'}, {'name': 'Бетонные смеси готовые к употреблению', 'consumption': 101.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Раствор тампонажный', 'consumption': 4.33, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 2.0, 'type': 'material', 'unit': 'м3'}, {'name': 'Лебедки вспомогательные шахтные с тяговым усилием 13,73 кН (1,4 т)', 'consumption': 11.45, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 9.14, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор глубинный', 'consumption': 195.0, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Пневмобетоноукладчики 3,3 м3', 'consumption': 36.54, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Пила цепная электрическая', 'consumption': 10.69, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 4,5', 'consumption': 3993.0, 'type': 'people', 'unit': 'чел.-ч'}], '06-01-031-14': [{'name': 'Электроды диаметром 4 мм Э42', 'consumption': 0.27, 'type': 'material', 'unit': 'т'}, {'name': 'Болты с гайками и шайбами строительные', 'consumption': 0.12, 'type': 'material', 'unit': 'т'}, {'name': 'Гвозди строительные', 'consumption': 0.0856, 'type': 'material', 'unit': 'т'}, {'name': 'Бруски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 40-75 мм, III сорта', 'consumption': 0.18, 'type': 'material', 'unit': 'м3'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 44 мм и более, III сорта', 'consumption': 2.31, 'type': 'material', 'unit': 'м3'}, {'name': 'Щиты из досок толщиной 25 мм', 'consumption': 98.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Арматура', 'consumption': 13.6, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон', 'consumption': 101.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Известь строительная негашеная комовая, сорт I', 'consumption': 0.069, 'type': 'material', 'unit': 'т'}, {'name': 'Вода', 'consumption': 0.206, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 77.59, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 0.97, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 0.27, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 224.91, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор глубинный', 'consumption': 60.1, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Пила цепная электрическая', 'consumption': 1.76, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 1.46, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 1201.9, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 78.83, 'type': 'people', 'unit': 'чел.-ч'}], '06-01-031-15': [{'name': 'Электроды диаметром 4 мм Э42', 'consumption': 0.2, 'type': 'material', 'unit': 'т'}, {'name': 'Болты с гайками и шайбами строительные', 'consumption': 0.09, 'type': 'material', 'unit': 'т'}, {'name': 'Гвозди строительные', 'consumption': 0.0512, 'type': 'material', 'unit': 'т'}, {'name': 'Бруски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 40-75 мм, III сорта', 'consumption': 0.14, 'type': 'material', 'unit': 'м3'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 44 мм и более, III сорта', 'consumption': 1.73, 'type': 'material', 'unit': 'м3'}, {'name': 'Щиты из досок толщиной 25 мм', 'consumption': 74.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Арматура', 'consumption': 10.1, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон', 'consumption': 101.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Известь строительная негашеная комовая, сорт I', 'consumption': 0.041, 'type': 'material', 'unit': 'т'}, {'name': 'Вода', 'consumption': 0.124, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 54.26, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 0.73, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 0.27, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 166.6, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор глубинный', 'consumption': 44.15, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Пила цепная электрическая', 'consumption': 1.31, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 1.11, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 881.79, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 55.26, 'type': 'people', 'unit': 'чел.-ч'}], '15-05-001-04': [{'name': 'Замазка оконная на олифе', 'consumption': 0.063, 'type': 'material', 'unit': 'т'}, {'name': 'Мыло твердое хозяйственное 72%', 'consumption': 1.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Олифа комбинированная, марки К-2', 'consumption': 0.0022, 'type': 'material', 'unit': 'т'}, {'name': 'Ветошь', 'consumption': 0.2, 'type': 'material', 'unit': 'кг'}, {'name': 'Стекло оконное', 'consumption': 157.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 0.33, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.46, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3', 'consumption': 51.08, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.33, 'type': 'people', 'unit': 'чел.-ч'}], '01-02-027-03': [{'name': 'Бульдозеры при работе на других видах строительства 79 кВт (108 л.с.)', 'consumption': 0.98, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автогрейдеры среднего типа 99 кВт(135 л.с.)', 'consumption': 0.51, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 1.49, 'type': 'people', 'unit': 'чел.-ч'}], '10-04-013-01': [{'name': 'Гвозди строительные', 'consumption': 0.0034, 'type': 'material', 'unit': 'т'}, {'name': 'Скобяные изделия', 'consumption': 0.0, 'type': 'material', 'unit': 'компл.'}, {'name': 'Блоки дверные', 'consumption': 100.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 1.37, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 2.06, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 73.14, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 1.37, 'type': 'people', 'unit': 'чел.-ч'}], '11-01-017-02': [{'name': 'Опилки древесные', 'consumption': 3.06, 'type': 'material', 'unit': 'м3'}, {'name': 'Карборунд', 'consumption': 2.0, 'type': 'material', 'unit': 'кг'}, {'name': 'Раствор декоративный (с каменной крошкой)', 'consumption': 2.04, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 5.85, 'type': 'material', 'unit': 'м3'}, {'name': 'Автопогрузчики 5 т', 'consumption': 1.09, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Подъемники грузоподъемностью до 500 кг одномачтовые, высота подъема 45 м', 'consumption': 1.0, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор поверхностный', 'consumption': 56.26, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Машины мозаично-шлифовальные', 'consumption': 32.0, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.22, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,4', 'consumption': 174.27, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 2.09, 'type': 'people', 'unit': 'чел.-ч'}], '10-05-001-02': [{'name': 'Грунтовка <Тифенгрунд>, КНАУФ', 'consumption': 20.0, 'type': 'material', 'unit': 'кг'}, {'name': 'Шпаклевка <Унифлот>, КНАУФ', 'consumption': 10.0, 'type': 'material', 'unit': 'кг'}, {'name': 'Шпаклевка <Фугенфюллер>, КНАУФ', 'consumption': 77.0, 'type': 'material', 'unit': 'кг'}, {'name': 'Лента бумажная для повышения трещиностойкости стыков ГКЛ и ГВЛ', 'consumption': 177.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Лента разделительная для сопряжения потолка из ЛГК со стеной', 'consumption': 162.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Листы гипсокартонные ГКЛ 12,5 мм', 'consumption': 226.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Шуруп самонарезающий (TN) 3,5/25 мм', 'consumption': 3788.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Дюбель-гвоздь 6/39 мм', 'consumption': 70.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Дюбель с шурупом 6/35 мм', 'consumption': 163.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Лента уплотнительная типа Дихтунгсбанд', 'consumption': 117.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Материалы теплоизоляционные из минеральных волокон', 'consumption': 103.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Верхний уголок для крепления несущих элементов двери 100x123 мм', 'consumption': 14.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Нижний уголок для крепления несущих элементов двери 100x123 мм', 'consumption': 14.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Профиль направляющий', 'consumption': 158.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Профиль стоечный', 'consumption': 254.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Бруски деревянные', 'consumption': 39.0, 'type': 'material', 'unit': 'метры'}, {'name': 'Шуруповерт', 'consumption': 3.2, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Ножницы электрические', 'consumption': 0.81, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Перфораторы электрические', 'consumption': 0.9, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,5', 'consumption': 103.0, 'type': 'people', 'unit': 'чел.-ч'}], '11-01-034-03': [{'name': 'Мастика битумно-кукерсольная холодная', 'consumption': 0.02, 'type': 'material', 'unit': 'т'}, {'name': 'Мастика клеящая каучуковая, марки КН-2', 'consumption': 50.0, 'type': 'material', 'unit': 'кг'}, {'name': 'Опилки древесные', 'consumption': 1.0, 'type': 'material', 'unit': 'м3'}, {'name': 'Паркет штучный', 'consumption': 102.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Вода', 'consumption': 0.2, 'type': 'material', 'unit': 'м3'}, {'name': 'Подъемники грузоподъемностью до 500 кг одномачтовые, высота подъема 45 м', 'consumption': 0.42, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Пила дисковая электрическая', 'consumption': 1.03, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Машина паркетно-шлифовальная', 'consumption': 4.9, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Машина для острожки деревянных полов', 'consumption': 2.1, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.6, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,8', 'consumption': 114.33, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 0.42, 'type': 'people', 'unit': 'чел.-ч'}], '11-01-027-03': [{'name': 'Плитки керамические для полов гладкие неглазурованные одноцветные с красителем квадратные и прямоугольные', 'consumption': 102.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Опилки древесные', 'consumption': 3.06, 'type': 'material', 'unit': 'м3'}, {'name': 'Раствор готовый кладочный тяжелый цементный', 'consumption': 1.3, 'type': 'material', 'unit': 'м3'}, {'name': 'Вода', 'consumption': 3.85, 'type': 'material', 'unit': 'м3'}, {'name': 'Автопогрузчики 5 т', 'consumption': 0.36, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Подъемники грузоподъемностью до 500 кг одномачтовые, высота подъема 45 м', 'consumption': 2.3, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.28, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 119.78, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 2.66, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-021-01': [{'name': 'Раствор готовый кладочный цементный марки 50', 'consumption': 0.23, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 35.84, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 96.75, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 35.84, 'type': 'people', 'unit': 'чел.-ч'}], '01-01-008-03': [{'name': 'Экскаваторы одноковшовые дизельные на гусеничном ходу при работе на других видах строительства 0,65 м3', 'consumption': 33.63, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 33.63, 'type': 'people', 'unit': 'чел.-ч'}], '06-01-031-05': [{'name': 'Электроды диаметром 4 мм Э42', 'consumption': 0.2, 'type': 'material', 'unit': 'т'}, {'name': 'Болты с гайками и шайбами строительные', 'consumption': 0.09, 'type': 'material', 'unit': 'т'}, {'name': 'Гвозди строительные', 'consumption': 0.051, 'type': 'material', 'unit': 'т'}, {'name': 'Бруски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 40-75 мм, III сорта', 'consumption': 0.14, 'type': 'material', 'unit': 'м3'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 44 мм и более, III сорта', 'consumption': 1.55, 'type': 'material', 'unit': 'м3'}, {'name': 'Щиты из досок толщиной 25 мм', 'consumption': 74.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Арматура', 'consumption': 10.1, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон', 'consumption': 101.5, 'type': 'material', 'unit': 'м3'}, {'name': 'Известь строительная негашеная комовая, сорт I', 'consumption': 0.041, 'type': 'material', 'unit': 'т'}, {'name': 'Вода', 'consumption': 0.124, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 54.1, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 0.71, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 0.27, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 166.6, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор глубинный', 'consumption': 42.6, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Пила цепная электрическая', 'consumption': 1.31, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 1.08, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,2', 'consumption': 852.04, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 55.08, 'type': 'people', 'unit': 'чел.-ч'}], '09-04-009-04': [{'name': 'Болты с гайками и шайбами строительные', 'consumption': 0.007, 'type': 'material', 'unit': 'т'}, {'name': 'Стеклопакеты двухслойные из неполированного стекла толщиной 4 мм', 'consumption': 94.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Элементы крепления нащельников и деталей обрамления (самонарезающиеся винты, заклепки т.д.)', 'consumption': 0.0, 'type': 'material', 'unit': 'т'}, {'name': 'Блоки оконные из алюминиевых сплавов', 'consumption': 0.0, 'type': 'material', 'unit': 'т'}, {'name': 'Нащельники и детали обрамления из алюминиевых сплавов', 'consumption': 0.0, 'type': 'material', 'unit': 'т'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 0.55, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на пневмоколесном ходу при работе на других видах строительства 25 т', 'consumption': 17.94, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Дрели электрические', 'consumption': 3.31, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.82, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 4,2', 'consumption': 437.92, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 18.49, 'type': 'people', 'unit': 'чел.-ч'}], '06-01-001-20': [{'name': 'Проволока горячекатаная в мотках, диаметром 6,3-6,5 мм', 'consumption': 0.028, 'type': 'material', 'unit': 'т'}, {'name': 'Рогожа', 'consumption': 88.2, 'type': 'material', 'unit': 'м2'}, {'name': 'Гвозди строительные', 'consumption': 0.018, 'type': 'material', 'unit': 'т'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 44 мм и более, III сорта', 'consumption': 0.22, 'type': 'material', 'unit': 'м3'}, {'name': 'Щиты из досок толщиной 25 мм', 'consumption': 44.8, 'type': 'material', 'unit': 'м2'}, {'name': 'Бетон', 'consumption': 102.0, 'type': 'material', 'unit': 'м3'}, {'name': 'Известь строительная негашеная комовая, сорт I', 'consumption': 0.025, 'type': 'material', 'unit': 'т'}, {'name': 'Вода', 'consumption': 0.283, 'type': 'material', 'unit': 'м3'}, {'name': 'Краны башенные при работе на других видах строительства 8 т', 'consumption': 21.3, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Краны на автомобильном ходу при работе на других видах строительства 10 т', 'consumption': 0.39, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автопогрузчики 5 т', 'consumption': 0.27, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Вибратор глубинный', 'consumption': 16.78, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Пила цепная электрическая', 'consumption': 0.74, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 0.65, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,1', 'consumption': 337.48, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 21.96, 'type': 'people', 'unit': 'чел.-ч'}], '07-01-006-06': [{'name': 'Проволока горячекатаная в мотках, диаметром 6,3-6,5 мм', 'consumption': 0.041, 'type': 'material', 'unit': 'т'}, {'name': 'Рубероид подкладочный с пылевидной посыпкой РПП-300б', 'consumption': 98.0, 'type': 'material', 'unit': 'м2'}, {'name': 'Смазка солидол жировой марки <Ж>', 'consumption': 0.009, 'type': 'material', 'unit': 'т'}, {'name': 'Электроды диаметром 6 мм Э42', 'consumption': 0.03, 'type': 'material', 'unit': 'т'}, {'name': 'Доски обрезные хвойных пород длиной 4-6,5 м, шириной 75-150 мм, толщиной 32-40 мм, IV сорта', 'consumption': 0.848, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструктивные элементы вспомогательного назначения с преобладанием профильного проката собираемые из двух и более деталей, с отверстиями и без отверстий, соединяемые на сварке', 'consumption': 0.26, 'type': 'material', 'unit': 'т'}, {'name': 'Горячекатаная арматурная сталь гладкая класса А-I, диаметром 14 мм', 'consumption': 0.02, 'type': 'material', 'unit': 'т'}, {'name': 'Бетон', 'consumption': 21.0, 'type': 'material', 'unit': 'м3'}, {'name': 'Конструкции сборные железобетонные', 'consumption': 100.0, 'type': 'material', 'unit': 'шт.'}, {'name': 'Краны на гусеничном ходу при работе на других видах строительства 25 т', 'consumption': 31.98, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Установки для сварки ручной дуговой(постоянного тока)', 'consumption': 9.48, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Автомобили бортовые, грузоподъемность до 5 т', 'consumption': 12.37, 'type': 'machine', 'unit': 'маш.-ч'}, {'name': 'Затраты труда рабочих-строителей Разряд 3,6', 'consumption': 223.11, 'type': 'people', 'unit': 'чел.-ч'}, {'name': 'Затраты труда машинистов  (справочно, входит в стоимость ЭМ)', 'consumption': 31.98, 'type': 'people', 'unit': 'чел.-ч'}]}

    #return

    project = MSProject(glob.glob(os.path.join(DIRECTORY, '*.mpp'))[0])

    # Добавление всех ресурсов в проект
    set_resources = set()
    for lst in resources_defsmeta.values():
        for r in lst:
            set_resources.add(r['name'])

    project.add_resources(set_resources)

    # project.close()
    # return
    # Добавление ресурсов в задачу
    resources_obj = project.get_resources_object()
    tasks_obj = project.get_tasks_object()
    list_tasks_obj = list(tasks_obj)
    resources = project.get_resources_name_id()

    for ind, task_vedom in enumerate(vedom[:], start=1):
        print(f'{ind}/{count_vedom}')
        for task_obj in list_tasks_obj:
            name_task_vedom = list(task_vedom.keys())[0].strip()
            if task_obj.Name.strip() == name_task_vedom:
                gsn = task_vedom[name_task_vedom]['gsn']
                gsn_def = resources_defsmeta[gsn]
                if not list(task_obj.Assignments):
                    for res_name in gsn_def:
                        res_id = resources[res_name['name']]
                        res_obj = resources_obj.Item(res_id)

                        if res_name['type'] == 'material':
                            res_obj.Type = 1
                            res_obj.MaterialLabel = res_name['unit']
                        elif res_name['type'] == 'machine':
                            res_obj.Group = "Машины"

                        elif res_name['type'] == 'people':
                            res_obj.Group = "Рабочие"

                        try:
                            task_obj.FixedDuration = True
                            t = task_obj.Assignments.Add(task_obj.ID, res_id)
                            #print(t.ResourceName)
                            if res_name['type'] == 'material':
                                t.Units = res_name['consumption'] * task_vedom[name_task_vedom]['volume']
                            else:
                                t.Work = res_name['consumption'] * task_vedom[name_task_vedom]['volume'] * 60
                                t.Units = 1

                            project._save_file()


                        except Exception as e:
                            print(e)

                    # project._save_file()
                    break

    project._close_file()
    #project.close()
    print('MSProject сформирован')
    # os.startfile('файлы\\Microsoft Project Document пустая.mpp')
    # print('Создание сводного файла по ресурсам')
    # Создание сводного файла по ресурсам
    # new_vedom = [['Наименование работ', 'Объем', ' ', 'ГЭСН', 'Материалы', 'ед. изм.', 'расход', ' '],
    #              [' ', 'Ед. изм.', 'Кол-во', ' ', ' ', ' ', 'Норм. на един работ', 'Кол-во'],
    #              ]
    #
    # summ_vedom = {}
    #
    # for ind, task_vedom in enumerate(vedom, start=1):
    #     new_vedom.append([])
    #     name_task_vedom = list(task_vedom.keys())[0].strip()
    #     work = task_vedom[name_task_vedom]
    #     gsn = work['gsn']
    #     gsn_def = resources_defsmeta[gsn]
    #     new_vedom[-1].append(name_task_vedom)
    #     new_vedom[-1].append(work['units_measurement'])
    #     new_vedom[-1].append(work['volume'])
    #     new_vedom[-1].append(gsn)
    #     for res_name in gsn_def:
    #         if res_name['type'] == 'material':
    #             new_vedom.append([None, None, None, None])
    #             new_vedom[-1].append(res_name['name'])
    #             new_vedom[-1].append(res_name['unit'])
    #             new_vedom[-1].append(res_name['consumption'])
    #             new_vedom[-1].append(res_name['consumption'] * task_vedom[name_task_vedom]['volume'])
    #             if summ_vedom.get(res_name['name']) is None:
    #                 summ_vedom[res_name['name']] = {
    #                     'unit': res_name['unit'],
    #                     'summa': res_name['consumption'] * task_vedom[name_task_vedom]['volume']
    #                 }
    #             else:
    #                 summ_vedom[res_name['name']]['summa'] += res_name['consumption'] * task_vedom[name_task_vedom][
    #                     'volume']
    #
    # wb = Workbook()
    # ws1 = wb.create_sheet("Ведомость ресурсов")
    # for row in new_vedom:
    #     ws1.append(row)
    #
    # ws1 = wb.create_sheet("Сводная таблица")
    # for row in [[k, v['unit'], v['summa']] for k, v in summ_vedom.items()]:
    #     ws1.append(row)
    #
    # del wb['Sheet']
    # wb.save('Материалы.xlsx')
    # os.startfile('Материалы.xlsx')


if __name__ == '__main__':
    # os.replace('Microsoft Project Document пустая.mpp','файлы\\Microsoft Project Document пустая.mpp')
    main()
